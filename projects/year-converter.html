<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Year Converter | Yuri Yasui</title>
  <link rel="stylesheet" href="../styles.css" />
</head>
<body>
  <header class="nav">
    <a class="logo" href="index.html#top">Yuri Yasui</a>
    <nav>
      <a href="index.html#projects">Projects</a>
      <a href="index.html#contact">Contact</a>
    </nav>
  </header>

  <main class="section">
    <h1 style="font-size:32px; margin-bottom:8px;">Japanese ⇄ Western Year Converter</h1>
    <p class="muted" style="margin-top:0;">
      GitHub Pages (JS) → API Gateway → AWS Lambda (Python) → JSON response
    </p>

    <div class="card" style="max-width:720px; margin-top:18px;">
      <h2 style="margin:0 0 10px; font-size:18px;">Try it</h2>

      <div class="form-row">
        <label for="era">Era</label>
        <select id="era">
          <option value="western">西暦</option>
          <option value="showa">昭和</option>
          <option value="heisei">平成</option>
          <option value="reiwa">令和</option>
        </select>
      </div>

      <div class="form-row">
        <label for="year">Year</label>
        <input type="number" id="year" placeholder="e.g. 1998" />
      </div>

      <div class="form-actions">
        <button class="btn" id="convert">Convert</button>
        <span id="status" class="muted"></span>
      </div>

      <div class="result">
        <p class="muted" style="margin:10px 0 6px;">Result</p>
        <div id="result" class="result-box">—</div>
      </div>
    </div>

    <div class="section" style="padding: 28px 0 0; max-width:720px;">
      <h2 style="font-size:18px;">What I built</h2>
      <p class="desc">
        I built a full-stack web service using JavaScript on GitHub Pages and Python on AWS.
        The frontend calls an API Gateway endpoint. AWS Lambda performs the conversion and returns JSON.
      </p>

      <!-- 画像があるなら -->
      <img src="Lecture Exercise-5.jpg" alt="Year Converter diagram" style="width:100%; border-radius:14px; border:1px solid var(--line); margin-top:10px;">
    </div>
  </main>

  <script>
    document.getElementById("convert").addEventListener("click", async function() {
      const apiEndpoint = "https://w946sa1cyc.execute-api.us-east-2.amazonaws.com/prod/yearConverter";
      const era = document.getElementById("era").value;
      const year = document.getElementById("year").value;
      const statusEl = document.getElementById("status");
      const resultEl = document.getElementById("result");

      if (!year) {
        resultEl.textContent = "Please enter a year.";
        return;
      }

      const urlWithParameters = `${apiEndpoint}?era=${encodeURIComponent(era)}&year=${encodeURIComponent(year)}`;

      try {
        statusEl.textContent = "Converting...";
        resultEl.textContent = "—";

        const response = await fetch(urlWithParameters);
        if (!response.ok) throw new Error(`HTTP ${response.status}`);

        const data = await response.json();
        resultEl.textContent = data.converted_year ?? "No result";
        statusEl.textContent = "";
      } catch (e) {
        console.error(e);
        statusEl.textContent = "";
        resultEl.textContent = "API Error. Please try again later.";
      }
    });
  </script>
</body>
</html>
